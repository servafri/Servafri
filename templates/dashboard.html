{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
    <h1>Welcome, {{ current_user.username }}!</h1>
    <div class="dashboard-container">
        <section class="user-info">
            <h2>Your Account</h2>
            <p>Current Balance: â‚¦{{ "%.2f"|format(current_user.balance) }}</p>
        </section>
        <section class="vm-list">
            <h2>Your Provisioned VMs</h2>
            {% if vms %}
                <ul>
                {% for vm in vms %}
                    <li>{{ vm.name }} - CPU: {{ vm.cpu_cores }}, RAM: {{ vm.ram }}GB, Disk: {{ vm.disk_size }}GB</li>
                {% endfor %}
                </ul>
            {% else %}
                <p>You haven't provisioned any VMs yet.</p>
            {% endif %}
        </section>
        <section class="provision-form">
            <h2>Provision a New VM</h2>
            <form method="POST" action="{{ url_for('auth.provision_vm') }}">
                {{ form.hidden_tag() }}
                <div class="form-group">
                    {{ form.name.label }}
                    {{ form.name() }}
                </div>
                <div class="form-group">
                    {{ form.cpu_cores.label }}
                    {{ form.cpu_cores() }}
                </div>
                <div class="form-group">
                    {{ form.ram.label }}
                    {{ form.ram() }}
                </div>
                <div class="form-group">
                    {{ form.disk_size.label }}
                    {{ form.disk_size() }}
                </div>
                <div class="form-group">
                    {{ form.submit() }}
                </div>
            </form>
        </section>
        <section class="billing-form">
            <h2>Add Funds to Your Account</h2>
            <form method="POST" action="{{ url_for('auth.payment') }}">
                {{ billing_form.hidden_tag() }}
                <div class="form-group">
                    {{ billing_form.amount.label }}
                    {{ billing_form.amount() }}
                </div>
                <div class="form-group">
                    {{ billing_form.email.label }}
                    {{ billing_form.email() }}
                </div>
                <div class="form-group">
                    {{ billing_form.submit() }}
                </div>
            </form>
        </section>
    </div>
{% endblock %}

{% block extra_js %}
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}
